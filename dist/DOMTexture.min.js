!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],e):e(t.DOMTexture={},t.THREE)}(this,function(t,e){"use strict";var n=""!==getComputedStyle(document.body).cssText;function i(t){var e=getComputedStyle(t);if(n)t.style.cssText=e.cssText;else for(var i in e){var s=e[i];isNaN(1*i)&&"function"!=typeof s&&!/^(cssText|length|parentRule)$/.test(i)&&(t.style[i]=s)}}var s=function(t){t=Object.assign({width:512,height:512,content:null},t);var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var n=document.createElement("svg");n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("width",t.width),n.setAttribute("height",t.height);var i=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");i.setAttribute("width","100%"),i.setAttribute("height","100%");var s=document.createElement("div");s.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),s.innerText="__content__",i.appendChild(s),n.appendChild(i);var o=document.createElement("img");o.onload=function(){this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(o,0,0),"function"==typeof this.renderComplete&&this.renderComplete()}.bind(this);var r=new FileReader;r.onloadend=function(){o.src=r.result},this.canvas=e,this.ctx=e.getContext("2d"),this.svg=n,this.img=o,this.reader=r,this.renderComplete=t.renderComplete,this.width=t.width,this.height=t.height,this.content=t.content};s.prototype={setWidth:function(t){return"number"==typeof t&&(this.width=t,this.canvas.width=t,this.svg.setAttribute("width",t)),this},setHeight:function(t){return"number"==typeof t&&(this.height=t,this.canvas.height=t,this.svg.setAttribute("height",t)),this},setContent:function(t){return this.content=t,this},setRenderComplete:function(t){return this.renderComplete=t,this},contentInlineStyle:function(){if(this.content instanceof Element){var t=this.content;i(t),t.querySelectorAll("*").forEach(i)}return this},render:function(t){t||(t=this.content);var e="";"string"==typeof t?e=t:t instanceof Element&&(e=t.outerHTML);var n=this.svg.outerHTML.replace("__content__",e),i=new Blob([n],{type:"image/svg+xml;charset=utf-8"});this.reader.readAsDataURL(i)}};var o=function(t,n,i,o,r,h,c,d,a,u){var l=new s(t);l.setRenderComplete(function(){this.version++}.bind(this)),e.Texture.call(this,l,n,i,o,r,h,c,d,a,u),this.domCanvas=l,Object.defineProperty(this,"needsUpdate",{set:function(t){!0===t&&l.render()}})};o.prototype=Object.assign(Object.create(e.Texture.prototype),{constructor:o,setWidth:function(t){this.domCanvas.setWidth(t)},setHeight:function(t){this.domCanvas.setHeight(t)},setContent:function(t){this.domCanvas.setContent(t)},domInlineStyle:function(){this.domCanvas.contentInlineStyle()}}),"undefined"!=typeof window&&"object"==typeof window.THREE&&(window.THREE.DOMCanvas=s,window.THREE.DOMTexture=o),t.DOMCanvas=s,t.DOMTexture=o,Object.defineProperty(t,"__esModule",{value:!0})});
