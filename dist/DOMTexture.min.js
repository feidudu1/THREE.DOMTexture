!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],e):e(t.DOMTexture={},t.THREE)}(this,function(t,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=""!==getComputedStyle(document.body).cssText;function u(t){var e=getComputedStyle(t);if(s)t.style.cssText=e.cssText;else for(var n in e){var i=e[n];isNaN(1*n)&&"function"!=typeof i&&!/^(cssText|length|parentRule)$/.test(n)&&(t.style[n]=i)}}var a=function(){function t(e){i(this,t),e=Object.assign({width:512,height:512,content:null},e);var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var o=document.createElement("svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("width",e.width),o.setAttribute("height",e.height);var r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");r.setAttribute("width","100%"),r.setAttribute("height","100%");var s=document.createElement("div");s.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),s.innerText="__content__",r.appendChild(s),o.appendChild(r);var u=document.createElement("img");u.onload=function(){this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(u,0,0),"function"==typeof this.renderComplete&&this.renderComplete()}.bind(this);var a=new FileReader;a.onloadend=function(){u.src=a.result},this.canvas=n,this.ctx=n.getContext("2d"),this.svg=o,this.img=u,this.reader=a,this.renderComplete=e.renderComplete,this.width=e.width,this.height=e.height,this.content=e.content}return o(t,[{key:"setWidth",value:function(t){return"number"==typeof t&&(this.width=t,this.canvas.width=t,this.svg.setAttribute("width",t)),this}},{key:"setHeight",value:function(t){return"number"==typeof t&&(this.height=t,this.canvas.height=t,this.svg.setAttribute("height",t)),this}},{key:"setContent",value:function(t){return this.content=t,this}},{key:"setRenderComplete",value:function(t){return this.renderComplete=t,this}},{key:"contentInlineStyle",value:function(){if(this.content instanceof Element){var t=this.content;u(t),t.querySelectorAll("*").forEach(u)}return this}},{key:"render",value:function(t){t||(t=this.content);var e="";"string"==typeof t?e=t:t instanceof Element&&(e=t.outerHTML);var n=this.svg.outerHTML.replace("__content__",e),i=new Blob([n],{type:"image/svg+xml;charset=utf-8"});this.reader.readAsDataURL(i)}}]),t}(),c=function(t){function n(t){var e;i(this,n);for(var o=new a(t),s=arguments.length,u=Array(s>1?s-1:0),c=1;c<s;c++)u[c-1]=arguments[c];var h=r(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this,o].concat(u)));return o.setRenderComplete(function(){this.version++}.bind(h)),h.domCanvas=o,Object.defineProperty(h,"needsUpdate",{set:function(t){!0===t&&o.render()}}),h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e.Texture),o(n,[{key:"setWidth",value:function(t){this.domCanvas.setWidth(t)}},{key:"setHeight",value:function(t){this.domCanvas.setHeight(t)}},{key:"setContent",value:function(t){this.domCanvas.setContent(t)}},{key:"domInlineStyle",value:function(){this.domCanvas.contentInlineStyle()}}]),n}();"undefined"!=typeof window&&"object"===n(window.THREE)&&(window.THREE.DOMCanvas=a,window.THREE.DOMTexture=c),t.DOMCanvas=a,t.DOMTexture=c,Object.defineProperty(t,"__esModule",{value:!0})});
